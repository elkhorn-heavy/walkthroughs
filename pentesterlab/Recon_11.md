# PentesterLab - Recon 11

PentesterLab offers a series of reconnaissance ("recon") challenges designed to
teach basic security skills.

## Challenge Overview

In this challenge, the goal is to brute force a virtual host using the `Host`
header. There is no DNS resolution set up for the host. The host will end with
`.hackycorp.com`.

Grade: Easy

## Initial Analysis

This is interesting. There is no DNS entry for the virtual host, so that removes
one option. However, we will be able to reach the site using hackycorp.com and
the correct `Host` request header.

Does "brute force" mean a real iteration of every DNS name we could think of?
The ASCII characters are only `a` to `z` plus `0` to `9`, and maybe `-` and a
couple of other characters. Or do they mean a dictionary attack? Or something
else?

Since the dictionary attack is a smaller space to search, we can start there.
The tool `ffuf` installs easily and is easy to figure out. Then problem is
finding a wordlist to use in the fuzzing, so borrowed the
[subdomain_megalist.txt](https://github.com/netsecurity-as/subfuz/blob/master/subdomain_megalist.txt)
from something called subfuz.

The first attempt is

```
$ ffuf -w subdomain_megalist.txt -H "Host: FUZZ.hackycorp.com" -u http://hackycorp.com
```

but this returned too many results, since they all return a 200 response for the
`recon_06` challenge. The tool allows us to filter out results using a regular
expression, although the expression here is a static string:

```
$ ffuf -w subdomain_megalist.txt -H "Host: FUZZ.hackycorp.com" -u http://hackycorp.com -fr recon_06
```

Success!

```
$ curl -H "Host: admin.hackycorp.com" hackycorp.com
<h1>Well done! You solved recon_11 </h1>

The key for this exercise is 00000000-0000-0000-0000-000000000000
```

> Note: the real challenge key has been replaced with a fake _UUID_.

> Note: the approach above also found the key for the next challenge! But let's
> wait until we see what hints it gives.

## Takeaways

This challenge is supposed to demonstrate how a virtual host can exist on a
server, even though there is no DNS name for it. In the real world this could be
due to a partially-decommissioned site, or a site under construction. This could
be the source of plenty of interesting information. Finding these sites isn't
easy, though, unless the subdomain is either guessed using a dictionary, or
truly brute forced by iterating through all possible subdomains - a huge task.

## Beyond the Challenge

### Alternative Methods to Solve the Challenge

There are plenty of other tools out there, such as the `subfuz` one used for the
dictionary. A custom script could be written but `ffuf` is fast because it uses
multiple threads to send requests in parallel.
